{"ast":null,"code":"import _defineProperty from\"C:/Users/Alexander/Desktop/Projects/store/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _toConsumableArray from\"C:/Users/Alexander/Desktop/Projects/store/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/Alexander/Desktop/Projects/store/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"C:/Users/Alexander/Desktop/Projects/store/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useEffect,useState}from'react';import{useParams}from'react-router-dom';import{useGetProductsQuery}from'../../store/api/apiSlice';import styles from'../../styles/Category.module.css';import Products from'../Products/Products';import{useSelector}from'react-redux';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Category=function Category(){var _useParams=useParams(),id=_useParams.id;var _useSelector=useSelector(function(_ref){var categories=_ref.categories;return categories;}),list=_useSelector.list;var defaultValues={title:'',price_min:0,price_max:0};var defaultParams=_objectSpread({categoryId:id,limit:5,offset:0},defaultValues);var _useState=useState(null),_useState2=_slicedToArray(_useState,2),cat=_useState2[0],setCat=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isEnd=_useState4[0],setIsEnd=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),items=_useState6[0],setItems=_useState6[1];var _useState7=useState(defaultValues),_useState8=_slicedToArray(_useState7,2),values=_useState8[0],setValues=_useState8[1];var _useState9=useState(defaultParams),_useState10=_slicedToArray(_useState9,2),params=_useState10[0],setParams=_useState10[1];var _useGetProductsQuery=useGetProductsQuery(params),_useGetProductsQuery$=_useGetProductsQuery.data,data=_useGetProductsQuery$===void 0?[]:_useGetProductsQuery$,isLoading=_useGetProductsQuery.isLoading,isSucces=_useGetProductsQuery.isSucces;useEffect(function(){if(!id)return;setItems([]);setIsEnd(false);setValues(defaultValues);setParams(_objectSpread(_objectSpread({},defaultParams),{},{categoryId:id}));},[id]);useEffect(function(){if(isLoading)return;if(!data.length)return setIsEnd(true);setItems(function(_items){return[].concat(_toConsumableArray(_items),_toConsumableArray(data));});},[data,isLoading]);useEffect(function(){if(!id||!list.length)return;var category=list.find(function(item){return item.id===id*1;});setCat(category);},[list,id]);var handleChange=function handleChange(_ref2){var _ref2$target=_ref2.target,value=_ref2$target.value,name=_ref2$target.name;setValues(_objectSpread(_objectSpread({},values),{},_defineProperty({},name,value)));};var handleSubmit=function handleSubmit(e){e.preventDefault();setItems([]);setIsEnd(false);setParams(_objectSpread(_objectSpread({},defaultParams),values));};var handleReset=function handleReset(){setValues(defaultValues);setParams(defaultParams);setIsEnd(false);};return/*#__PURE__*/_jsxs(\"section\",{className:styles.wrapper,children:[/*#__PURE__*/_jsx(\"h2\",{className:styles.title,children:cat===null||cat===void 0?void 0:cat.name}),/*#__PURE__*/_jsxs(\"form\",{className:styles.filters,onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.filter,children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"title\",onChange:handleChange,placeholder:\"Product name\",value:values.title})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.filter,children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"price_min\",onChange:handleChange,placeholder:\"0\",value:values.price_min}),/*#__PURE__*/_jsx(\"span\",{children:\"Price form\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.filter,children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"price_max\",onChange:handleChange,placeholder:\"0\",value:values.max}),/*#__PURE__*/_jsx(\"span\",{children:\"Price to\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",hidden:true})]}),isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"preloader\",children:\"Loading...\"}):!isSucces||!items.length?/*#__PURE__*/_jsxs(\"div\",{className:styles.back,children:[/*#__PURE__*/_jsx(\"span\",{children:\"No results\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleReset,children:\"Reset\"})]}):/*#__PURE__*/_jsx(Products,{title:\"\",products:items,style:{padding:0},amount:items.length}),!isEnd&&/*#__PURE__*/_jsx(\"div\",{className:styles.more,children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setParams(_objectSpread(_objectSpread({},params),{},{offset:params.offset+params.limit}));},children:\"See more\"})})]});};export default Category;","map":{"version":3,"names":["useEffect","useState","useParams","useGetProductsQuery","styles","Products","useSelector","jsx","_jsx","jsxs","_jsxs","Category","_useParams","id","_useSelector","_ref","categories","list","defaultValues","title","price_min","price_max","defaultParams","_objectSpread","categoryId","limit","offset","_useState","_useState2","_slicedToArray","cat","setCat","_useState3","_useState4","isEnd","setIsEnd","_useState5","_useState6","items","setItems","_useState7","_useState8","values","setValues","_useState9","_useState10","params","setParams","_useGetProductsQuery","_useGetProductsQuery$","data","isLoading","isSucces","length","_items","concat","_toConsumableArray","category","find","item","handleChange","_ref2","_ref2$target","target","value","name","_defineProperty","handleSubmit","e","preventDefault","handleReset","className","wrapper","children","filters","onSubmit","filter","type","onChange","placeholder","max","hidden","back","onClick","products","style","padding","amount","more"],"sources":["C:/Users/Alexander/Desktop/Projects/store/src/components/Categories/Category.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { useGetProductsQuery } from '../../store/api/apiSlice';\r\nimport styles from '../../styles/Category.module.css';\r\nimport Products from '../Products/Products';\r\nimport { useSelector } from 'react-redux';\r\n\r\nconst Category = () => {\r\n  const { id } = useParams();\r\n  const { list } = useSelector(({ categories }) => categories);\r\n  const defaultValues = {\r\n    title: '',\r\n    price_min: 0,\r\n    price_max: 0,\r\n  };\r\n  const defaultParams = {\r\n    categoryId: id,\r\n    limit: 5,\r\n    offset: 0,\r\n    ...defaultValues,\r\n  };\r\n  const [cat, setCat] = useState(null);\r\n  const [isEnd, setIsEnd] = useState(false);\r\n  const [items, setItems] = useState([]);\r\n  const [values, setValues] = useState(defaultValues);\r\n  const [params, setParams] = useState(defaultParams);\r\n  const { data = [], isLoading, isSucces } = useGetProductsQuery(params);\r\n  useEffect(() => {\r\n    if (!id) return;\r\n    setItems([]);\r\n    setIsEnd(false);\r\n    setValues(defaultValues);\r\n    setParams({ ...defaultParams, categoryId: id });\r\n  }, [id]);\r\n  useEffect(() => {\r\n    if (isLoading) return;\r\n    if (!data.length) return setIsEnd(true);\r\n    setItems((_items) => [..._items, ...data]);\r\n  }, [data, isLoading]);\r\n  useEffect(() => {\r\n    if (!id || !list.length) return;\r\n    const category = list.find((item) => item.id === id * 1);\r\n    setCat(category);\r\n  }, [list, id]);\r\n  const handleChange = ({ target: { value, name } }) => {\r\n    setValues({ ...values, [name]: value });\r\n  };\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    setItems([]);\r\n    setIsEnd(false);\r\n    setParams({ ...defaultParams, ...values });\r\n  };\r\n  const handleReset = () => {\r\n    setValues(defaultValues);\r\n    setParams(defaultParams);\r\n    setIsEnd(false);\r\n  };\r\n  return (\r\n    <section className={styles.wrapper}>\r\n      <h2 className={styles.title}>{cat?.name}</h2>\r\n      <form className={styles.filters} onSubmit={handleSubmit}>\r\n        <div className={styles.filter}>\r\n          <input\r\n            type=\"text\"\r\n            name=\"title\"\r\n            onChange={handleChange}\r\n            placeholder=\"Product name\"\r\n            value={values.title}\r\n          />\r\n        </div>\r\n        <div className={styles.filter}>\r\n          <input\r\n            type=\"number\"\r\n            name=\"price_min\"\r\n            onChange={handleChange}\r\n            placeholder=\"0\"\r\n            value={values.price_min}\r\n          />\r\n          <span>Price form</span>\r\n        </div>\r\n        <div className={styles.filter}>\r\n          <input\r\n            type=\"number\"\r\n            name=\"price_max\"\r\n            onChange={handleChange}\r\n            placeholder=\"0\"\r\n            value={values.max}\r\n          />\r\n          <span>Price to</span>\r\n        </div>\r\n        <button type=\"submit\" hidden />\r\n      </form>\r\n      {isLoading ? (\r\n        <div className=\"preloader\">Loading...</div>\r\n      ) : !isSucces || !items.length ? (\r\n        <div className={styles.back}>\r\n          <span>No results</span>\r\n          <button onClick={handleReset}>Reset</button>\r\n        </div>\r\n      ) : (\r\n        <Products\r\n          title=\"\"\r\n          products={items}\r\n          style={{ padding: 0 }}\r\n          amount={items.length}\r\n        />\r\n      )}\r\n      {!isEnd && (\r\n        <div className={styles.more}>\r\n          <button\r\n            onClick={() =>\r\n              setParams({ ...params, offset: params.offset + params.limit })\r\n            }\r\n          >\r\n            See more\r\n          </button>\r\n        </div>\r\n      )}\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Category;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}